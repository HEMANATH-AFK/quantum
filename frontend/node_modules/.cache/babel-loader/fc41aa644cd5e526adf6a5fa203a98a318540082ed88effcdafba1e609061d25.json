{"ast":null,"code":"import jwt from 'jsonwebtoken';\nexport const generateToken = user => {\n  return jwt.sign({\n    _id: user._id,\n    name: user.name,\n    email: user.email,\n    isAdmin: user.isAdmin\n  }, process.env.JWT_SECRET, {\n    expiresIn: '30d'\n  });\n};\nexport const isAuth = (req, res, next) => {\n  const authorization = req.headers.authorization;\n  if (authorization) {\n    const token = authorization.slice(7, authorization.length); // Bearer XXXXXX\n    jwt.verify(token, process.env.JWT_SECRET, (err, decode) => {\n      if (err) {\n        res.status(401).send({\n          message: 'Invalid Token'\n        });\n      } else {\n        req.user = decode;\n        next();\n      }\n    });\n  } else {\n    res.status(401).send({\n      message: 'No Token'\n    });\n  }\n};\nexport const isAdmin = (req, res, next) => {\n  if (req.user && req.user.isAdmin) {\n    next();\n  } else {\n    res.status(401).send({\n      message: 'Invalid Admin Token'\n    });\n  }\n};","map":{"version":3,"names":["jwt","generateToken","user","sign","_id","name","email","isAdmin","process","env","JWT_SECRET","expiresIn","isAuth","req","res","next","authorization","headers","token","slice","length","verify","err","decode","status","send","message"],"sources":["C:/Users/KALAI/Desktop/Quantum/frontend/src/utils.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nexport const generateToken = (user) => {\r\n  return jwt.sign(\r\n    {\r\n      _id: user._id,\r\n      name: user.name,\r\n      email: user.email,\r\n      isAdmin: user.isAdmin,\r\n    },\r\n    process.env.JWT_SECRET,\r\n    {\r\n      expiresIn: '30d',\r\n    }\r\n  );\r\n};\r\n\r\nexport const isAuth = (req, res, next) => {\r\n  const authorization = req.headers.authorization;\r\n  if (authorization) {\r\n    const token = authorization.slice(7, authorization.length); // Bearer XXXXXX\r\n    jwt.verify(token, process.env.JWT_SECRET, (err, decode) => {\r\n      if (err) {\r\n        res.status(401).send({ message: 'Invalid Token' });\r\n      } else {\r\n        req.user = decode;\r\n        next();\r\n      }\r\n    });\r\n  } else {\r\n    res.status(401).send({ message: 'No Token' });\r\n  }\r\n};\r\n\r\nexport const isAdmin = (req, res, next) => {\r\n  if (req.user && req.user.isAdmin) {\r\n    next();\r\n  } else {\r\n    res.status(401).send({ message: 'Invalid Admin Token' });\r\n  }\r\n};"],"mappings":"AAAA,OAAOA,GAAG,MAAM,cAAc;AAE9B,OAAO,MAAMC,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAOF,GAAG,CAACG,IAAI,CACb;IACEC,GAAG,EAAEF,IAAI,CAACE,GAAG;IACbC,IAAI,EAAEH,IAAI,CAACG,IAAI;IACfC,KAAK,EAAEJ,IAAI,CAACI,KAAK;IACjBC,OAAO,EAAEL,IAAI,CAACK;EAChB,CAAC,EACDC,OAAO,CAACC,GAAG,CAACC,UAAU,EACtB;IACEC,SAAS,EAAE;EACb,CACF,CAAC;AACH,CAAC;AAED,OAAO,MAAMC,MAAM,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACxC,MAAMC,aAAa,GAAGH,GAAG,CAACI,OAAO,CAACD,aAAa;EAC/C,IAAIA,aAAa,EAAE;IACjB,MAAME,KAAK,GAAGF,aAAa,CAACG,KAAK,CAAC,CAAC,EAAEH,aAAa,CAACI,MAAM,CAAC,CAAC,CAAC;IAC5DpB,GAAG,CAACqB,MAAM,CAACH,KAAK,EAAEV,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE,CAACY,GAAG,EAAEC,MAAM,KAAK;MACzD,IAAID,GAAG,EAAE;QACPR,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAgB,CAAC,CAAC;MACpD,CAAC,MAAM;QACLb,GAAG,CAACX,IAAI,GAAGqB,MAAM;QACjBR,IAAI,CAAC,CAAC;MACR;IACF,CAAC,CAAC;EACJ,CAAC,MAAM;IACLD,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAW,CAAC,CAAC;EAC/C;AACF,CAAC;AAED,OAAO,MAAMnB,OAAO,GAAGA,CAACM,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACzC,IAAIF,GAAG,CAACX,IAAI,IAAIW,GAAG,CAACX,IAAI,CAACK,OAAO,EAAE;IAChCQ,IAAI,CAAC,CAAC;EACR,CAAC,MAAM;IACLD,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAsB,CAAC,CAAC;EAC1D;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}